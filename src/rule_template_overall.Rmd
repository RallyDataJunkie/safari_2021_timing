

```{python, results='hide'}
import pandas as pd

pd_df = r.multi_overall_wide_gap_top10_view[['code', r.last_stage_code]]
#pd_df = r.top10_stage_times

pd_df  = pd.melt(pd_df, id_vars=['code'], value_vars=[r.last_stage_code],
                 var_name='stage', value_name='gap')
pd_df['position'] = pd_df['gap'].rank()
pd_df['diff'] = pd_df['gap'].diff()
# Generates cols: code, stage, gap
txts=[]
pd_df.head().apply(rulesbyrow, ruleset='rule_multi_overall', axis=1)
txt_out = '\n\n'.join(txts)
```
